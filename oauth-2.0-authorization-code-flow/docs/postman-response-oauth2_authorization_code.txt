

# A. Acquire Auth code

## 1. from eclipse +browser
https://login.microsoftonline.com/common/oauth2/v2.0/authorize?scope=+offline_access+openid+profile&response_type=code&redirect_uri=https%3A%2F%2Flocalhost%3A8443%2Fmsal4jsample%2Fsecure%2Faad&state=43ef8839-3b7e-4398-a790-89a87b25878c&nonce=0e5ceed0-9578-40af-99b8-b75c844227cc&prompt=select_account&client_id=b01b4114-de39-48b1-af96-84cc1d0e67e3&response_mode=query

response_mode

https://localhost:8443/msal4jsample/secure/aad?code=OAQABAAIAAAAGV_bv21oQQ4ROqh0_1-tA_PWLh8HnRxbIsoofeAvSgrDwj2Cob6OdVjT9plhl0du7pJB50wSLkOsuoxjuZDyjH6AYFSgRqtADoLwjmZ4ZkpUd2LFJlJGQVtCK5S8dCvTfATgLqKk7o-Q-Gj71ldQuhdjCGUiycqG-lbUewuIUadRJWPkzeVTRfB5Qk0gteUD0zLDcM7IbE8JUmMGA0VAEB4cKHayK3-ZK1f_r8vbZ5gSi-qOXzbDkbfVbSNOx54WEHogNJ2QxgpgEdE1AIXch5QTqGWNYXa8v8tF3FmllwgxsnoIx__QB6NCvbSn5RLVVNk0o98KhF_A-Kams94HkcBFAWMnSvpVgXpB9Pl0eJScm3zNjpZJLH9AGFoB00Xwpsj-vbKTDYhITVo9KBdW8EeZM3gErrwN4JAyw8htz5Nh5tZ9JbQIdCdQxREjnhqFur_APE9o0eloTjBt4v3Z7ts5hquYcNEKN-fjZX6NSTkiBcu9BMlnuLXucHkyIDExq2tUK_1VZZxUnOP_xCfkLYy5rGrffVgK3ENAv5EQbKjEr0O76G4sHXTPcT2yKnu4GadttNKvoGAvyskUBETMiNpn2xxJhyy_bAsFnzlc12W53X8lFNW2xNeKpxBCnS1PRmII2wvcIzHR2rZAKrzidYm5Q2MfUvEo_zU4M8CVPmlQAkRdvAQ_WoOnv-2Yegy4gAA&state=43ef8839-3b7e-4398-a790-89a87b25878c&session_state=8d79bc2f-c690-4eca-905c-ebc1f7e739c9


OAQABAAIAAAAGV_bv21oQQ4ROqh0_1-tA_PWLh8HnRxbIsoofeAvSgrDwj2Cob6OdVjT9plhl0du7pJB50wSLkOsuoxjuZDyjH6AYFSgRqtADoLwjmZ4ZkpUd2LFJlJGQVtCK5S8dCvTfATgLqKk7o-Q-Gj71ldQuhdjCGUiycqG-lbUewuIUadRJWPkzeVTRfB5Qk0gteUD0zLDcM7IbE8JUmMGA0VAEB4cKHayK3-ZK1f_r8vbZ5gSi-qOXzbDkbfVbSNOx54WEHogNJ2QxgpgEdE1AIXch5QTqGWNYXa8v8tF3FmllwgxsnoIx__QB6NCvbSn5RLVVNk0o98KhF_A-Kams94HkcBFAWMnSvpVgXpB9Pl0eJScm3zNjpZJLH9AGFoB00Xwpsj-vbKTDYhITVo9KBdW8EeZM3gErrwN4JAyw8htz5Nh5tZ9JbQIdCdQxREjnhqFur_APE9o0eloTjBt4v3Z7ts5hquYcNEKN-fjZX6NSTkiBcu9BMlnuLXucHkyIDExq2tUK_1VZZxUnOP_xCfkLYy5rGrffVgK3ENAv5EQbKjEr0O76G4sHXTPcT2yKnu4GadttNKvoGAvyskUBETMiNpn2xxJhyy_bAsFnzlc12W53X8lFNW2xNeKpxBCnS1PRmII2wvcIzHR2rZAKrzidYm5Q2MfUvEo_zU4M8CVPmlQAkRdvAQ_WoOnv-2Yegy4gAA


## 2. from postman

https://login.microsoftonline.com/common/oauth2/v2.0/authorize?scope=openid offline_access https://graph.microsoft.com/mail.read&response_type=code&redirect_uri=https://localhost:8443/msal4jsample/secure/aad&state=43ef8839-3b7e-4398-a790-89a87b25878c&nonce=0e5ceed0-9578-40af-99b8-b75c844227cc&prompt=select_account&client_id=b01b4114-de39-48b1-af96-84cc1d0e67e3&response_mode=query

response

https://localhost:8443/msal4jsample/secure/aad?code=OAQABAAIAAAAGV_bv21oQQ4ROqh0_1-tAFpDgW0deccee1IMZ-l_hLqjm-l3Gzw0Zp29qbeeHrSQWK-Knry3Gah09fpcNtOIcBmGUtrK-sFQzNgWA7sJwjZAMpQ5W-RVCMgCUIizio7Gnw7PjKzQbDXfAiX-Bt7glH2X3TVOIRApDa_muPKDFRhOs8d_s28bI38O4Fz02nhI2EaL7usA9_vlH3SQM_ZjJMYkrQFh4aGBfz4NPTLqBX-3HDVUpg9koAoYzdEm6FQylyVUh5EZGnb0R1f0JXYDxObfQQZhjnAUd5g1cBXqZyui9J2RPITLmdd9wmB8EC1pKERiXsHJuM-RiGllJxIhBeGZBRhTQDlsdAUsMbxsDeIQ0qkylpBdFXZaSiybq_Anu7EBaTWSz6VX0E0-YiCnKo5a3nnB3Bo2p5Ng8L8ZzOEa_LgcbuO0P05qLmpDW9KbnFZmimklPULaxKcUanDGhMTOwDkQopCf8FIZoRBRIt_YcnKUXV_KWN5yxpqW4Ul0JC2RdioAr3mLDCpEGyJiwR23_CxsJugoljXL2EYWPcMVc7bn2XddgIgbovYS1CByju84gZxoC_6CRcdpMugPnbLRUCOWwmrvY7f4wqXlFbzq6wwufmLDjFY4uuxk8EmSUVGN_sJVyAHulTTrBTVBQ0csNkGmlwRYEwQ0s8KicaJl_PCnmi5cAO4h7PrCZ5g0n0oEoWAaXuylueKdK2ggZIAA&state=43ef8839-3b7e-4398-a790-89a87b25878c&session_state=bf45c289-e9a4-4da5-9771-7dac00fbd21c


OAQABAAIAAAAGV_bv21oQQ4ROqh0_1-tAFpDgW0deccee1IMZ-l_hLqjm-l3Gzw0Zp29qbeeHrSQWK-Knry3Gah09fpcNtOIcBmGUtrK-sFQzNgWA7sJwjZAMpQ5W-RVCMgCUIizio7Gnw7PjKzQbDXfAiX-Bt7glH2X3TVOIRApDa_muPKDFRhOs8d_s28bI38O4Fz02nhI2EaL7usA9_vlH3SQM_ZjJMYkrQFh4aGBfz4NPTLqBX-3HDVUpg9koAoYzdEm6FQylyVUh5EZGnb0R1f0JXYDxObfQQZhjnAUd5g1cBXqZyui9J2RPITLmdd9wmB8EC1pKERiXsHJuM-RiGllJxIhBeGZBRhTQDlsdAUsMbxsDeIQ0qkylpBdFXZaSiybq_Anu7EBaTWSz6VX0E0-YiCnKo5a3nnB3Bo2p5Ng8L8ZzOEa_LgcbuO0P05qLmpDW9KbnFZmimklPULaxKcUanDGhMTOwDkQopCf8FIZoRBRIt_YcnKUXV_KWN5yxpqW4Ul0JC2RdioAr3mLDCpEGyJiwR23_CxsJugoljXL2EYWPcMVc7bn2XddgIgbovYS1CByju84gZxoC_6CRcdpMugPnbLRUCOWwmrvY7f4wqXlFbzq6wwufmLDjFY4uuxk8EmSUVGN_sJVyAHulTTrBTVBQ0csNkGmlwRYEwQ0s8KicaJl_PCnmi5cAO4h7PrCZ5g0n0oEoWAaXuylueKdK2ggZIAA


# B. Get Access token using auth code from Step A

POST https://login.microsoftonline.com/common/oauth2/v2.0/token

client_id:b01b4114-de39-48b1-af96-84cc1d0e67e3
scope:https://graph.microsoft.com/mail.read
redirect_uri:https://localhost:8443/msal4jsample/secure/aad
grant_type:authorization_code
client_secret:nNIAavm.6GJyKyJi10owCs4yhk.9u_fLa_
code:OAQABAAIAAAAGV_bv21oQQ4ROqh0_1-tAFpDgW0deccee1IMZ-l_hLqjm-l3Gzw0Zp29qbeeHrSQWK-Knry3Gah09fpcNtOIcBmGUtrK-sFQzNgWA7sJwjZAMpQ5W-RVCMgCUIizio7Gnw7PjKzQbDXfAiX-Bt7glH2X3TVOIRApDa_muPKDFRhOs8d_s28bI38O4Fz02nhI2EaL7usA9_vlH3SQM_ZjJMYkrQFh4aGBfz4NPTLqBX-3HDVUpg9koAoYzdEm6FQylyVUh5EZGnb0R1f0JXYDxObfQQZhjnAUd5g1cBXqZyui9J2RPITLmdd9wmB8EC1pKERiXsHJuM-RiGllJxIhBeGZBRhTQDlsdAUsMbxsDeIQ0qkylpBdFXZaSiybq_Anu7EBaTWSz6VX0E0-YiCnKo5a3nnB3Bo2p5Ng8L8ZzOEa_LgcbuO0P05qLmpDW9KbnFZmimklPULaxKcUanDGhMTOwDkQopCf8FIZoRBRIt_YcnKUXV_KWN5yxpqW4Ul0JC2RdioAr3mLDCpEGyJiwR23_CxsJugoljXL2EYWPcMVc7bn2XddgIgbovYS1CByju84gZxoC_6CRcdpMugPnbLRUCOWwmrvY7f4wqXlFbzq6wwufmLDjFY4uuxk8EmSUVGN_sJVyAHulTTrBTVBQ0csNkGmlwRYEwQ0s8KicaJl_PCnmi5cAO4h7PrCZ5g0n0oEoWAaXuylueKdK2ggZIAA


Response access token
eyJ0eXAiOiJKV1QiLCJub25jZSI6Ijh5dHE1WkFpdVU1dGloSzNiQVRQTVpBOG1sVVlwUkc3bnhBdjdiYUVPbmciLCJhbGciOiJSUzI1NiIsIng1dCI6Imh1Tjk1SXZQZmVocTM0R3pCRFoxR1hHaXJuTSIsImtpZCI6Imh1Tjk1SXZQZmVocTM0R3pCRFoxR1hHaXJuTSJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9lMTJjOWY4ZS1lY2IzLTRjYmQtYjUwNC05NDEwYWI5MTE2YWUvIiwiaWF0IjoxNTk1MjY0MDYzLCJuYmYiOjE1OTUyNjQwNjMsImV4cCI6MTU5NTI2Nzk2MywiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkUyQmdZTmcyWjlkajVmek9udnpicS9LbTMrT1QxenJhbHV2SXYwaFhxUGJ4SW83S1Ava0EiLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6ImphdmFfd2ViYXBwIiwiYXBwaWQiOiJiMDFiNDExNC1kZTM5LTQ4YjEtYWY5Ni04NGNjMWQwZTY3ZTMiLCJhcHBpZGFjciI6IjEiLCJpcGFkZHIiOiI5My4yMDIuMTE4LjEyNyIsIm5hbWUiOiJUZXN0IFVzZXIiLCJvaWQiOiJiMGMxNTBhOS0yN2RkLTQwNzEtOGYyYi00NWE0YjRkMGUwMWMiLCJwbGF0ZiI6IjMiLCJwdWlkIjoiMTAwMzIwMDBDRkMyNjg2NyIsInNjcCI6Ik1haWwuUmVhZCBvcGVuaWQgVXNlci5SZWFkIHByb2ZpbGUgZW1haWwiLCJzdWIiOiJOeEQ2Z1IzX0xYTmlSN0c2WmNpc3NpdXRsVngteGlVVFpvVmZ5U1FudHlNIiwidGVuYW50X3JlZ2lvbl9zY29wZSI6IkFTIiwidGlkIjoiZTEyYzlmOGUtZWNiMy00Y2JkLWI1MDQtOTQxMGFiOTExNmFlIiwidW5pcXVlX25hbWUiOiJ0ZXN0LXVzZXJAcmF2aWp1bHkyMDIwcmVkaWZmbWFpbC5vbm1pY3Jvc29mdC5jb20iLCJ1cG4iOiJ0ZXN0LXVzZXJAcmF2aWp1bHkyMDIwcmVkaWZmbWFpbC5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiI2ZllIRnJfS3UwcUFfeGtSVHJEVUFRIiwidmVyIjoiMS4wIiwieG1zX3N0Ijp7InN1YiI6ImxwYk5CSktQM2xRM29SaGRPbFh0QlZwcUtqeDdzU0VaNXVCaXRNSVQ0eUUifSwieG1zX3RjZHQiOjE1OTQ0NzA4MzN9.oYMqrR8K53slPeTlhaHe1GCCG9vp99ENJYjJzmvoyBevCltgKCSqz6qZL-US11cs7ynNINiMucYASm62RJ4qVZRfmbXgrTXTgRZUSB10FEJUje12roHwDZeTcxp90EGGvQMjOeofJqtOCEjMOmQjaCC0pK6Ll12rs0esLnvyHHIdayb_KMvUeQXkw4R8Xfs5w0Eyuz-QL8ZTRpbOHziGdXJZxw_e7V9G48U2CvBbZVSm5gcgqSs18lz6M9b-eO7oMW5Y6M4HJqlkVspraVig5YmONP14YQWHctDCZVdx5YLFXXe87wSdBIuPEM_kQKneRPoQM-fSZGFoEFjMOxTjkA

refresh token
OAQABAAAAAAAGV_bv21oQQ4ROqh0_1-tAi0Z2tJqxNQMwen7TPU84KouiuTLR8KNYnLu51IUCpOvsToXnSnJkORoyt0Nu7Al62JoOkFYNFu88ZH_mhd1hyEGfwmD5mZ_hpYcy34jxMvYIcOfQGi-jU7efN_vlaCSPnioUblvfJ7GbsPWsxKk8B3YkRR6ndRuKwKG0DW08HE8qSuQvbZjcAHQrXMWceP8_KsSLlYs-729viX_MJD1jJIDpmzqUbX8tgIj33k_YiHxy9FtOUj9YoMFgIPB1GevxK3qrTe5Oow5MsxDl_ST9LVJO4Jj4lSnx318_jIus7Xq0pyEYDMr-a_BXwBMRiGxEFS2wcxapHOSrX5B1x9cQ_dxyp_Pe8OG8VOZCISNADTo9EJ3K0dMFBILf0oc3vSAVQvit-7sVchUzbadOEBBrBdWRhJRY3_yJxU_SIWH95CeJuo6_2D04X6Kg4rMG5SyzcLYpJhQ8bZLnLAiKEI669Qgc8GTpQTPFCoukgsibvhqcGRpQZCuigGp8J_-E6cmJCkZCeTi4SIEPSwT2dXmYElXyWFo-HthmCk-wlSPgVawHUDHiAgliJlZ2zPZHhvKIcFc-ENs1Y7_sVbzWq_q_jGGHpsrniXEVgZxeUFERh6TanKg5yhTiSqcCPoBMUuspX8bpCSh_HN-OC4CHo9zcdbFXpoi0NWNh9D5ozW1xUUONHw38B3TzXMytcnWaDeRUaSC4PH9THQkzF2qorb6a-EvWOXQN-T5js-46eZEcOTPFIEFcgzG8vpzWZwuorrnmraYzsWJZ0uDw9QJhSCAGcTwB-X8QCvYdzFmPGrD12SZeUrz8e5HIY8ipONJxZyN8PIN1DT7V3p40v5p5DkrCBwnvCE5b2RsEkxvcp5C1o1vOTb6o17panGVQLO0bYsztXAXdGR6cLt-g7XoKDnG-WeCOicxdtTTxbSSzwi3dlqjM77N2ItCdHqpfmO3rBwzGIAA




# C . Call Graph API

https://graph.microsoft.com/

Authorization:Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6Ijh5dHE1WkFpdVU1dGloSzNiQVRQTVpBOG1sVVlwUkc3bnhBdjdiYUVPbmciLCJhbGciOiJSUzI1NiIsIng1dCI6Imh1Tjk1SXZQZmVocTM0R3pCRFoxR1hHaXJuTSIsImtpZCI6Imh1Tjk1SXZQZmVocTM0R3pCRFoxR1hHaXJuTSJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9lMTJjOWY4ZS1lY2IzLTRjYmQtYjUwNC05NDEwYWI5MTE2YWUvIiwiaWF0IjoxNTk1MjY0MDYzLCJuYmYiOjE1OTUyNjQwNjMsImV4cCI6MTU5NTI2Nzk2MywiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkUyQmdZTmcyWjlkajVmek9udnpicS9LbTMrT1QxenJhbHV2SXYwaFhxUGJ4SW83S1Ava0EiLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6ImphdmFfd2ViYXBwIiwiYXBwaWQiOiJiMDFiNDExNC1kZTM5LTQ4YjEtYWY5Ni04NGNjMWQwZTY3ZTMiLCJhcHBpZGFjciI6IjEiLCJpcGFkZHIiOiI5My4yMDIuMTE4LjEyNyIsIm5hbWUiOiJUZXN0IFVzZXIiLCJvaWQiOiJiMGMxNTBhOS0yN2RkLTQwNzEtOGYyYi00NWE0YjRkMGUwMWMiLCJwbGF0ZiI6IjMiLCJwdWlkIjoiMTAwMzIwMDBDRkMyNjg2NyIsInNjcCI6Ik1haWwuUmVhZCBvcGVuaWQgVXNlci5SZWFkIHByb2ZpbGUgZW1haWwiLCJzdWIiOiJOeEQ2Z1IzX0xYTmlSN0c2WmNpc3NpdXRsVngteGlVVFpvVmZ5U1FudHlNIiwidGVuYW50X3JlZ2lvbl9zY29wZSI6IkFTIiwidGlkIjoiZTEyYzlmOGUtZWNiMy00Y2JkLWI1MDQtOTQxMGFiOTExNmFlIiwidW5pcXVlX25hbWUiOiJ0ZXN0LXVzZXJAcmF2aWp1bHkyMDIwcmVkaWZmbWFpbC5vbm1pY3Jvc29mdC5jb20iLCJ1cG4iOiJ0ZXN0LXVzZXJAcmF2aWp1bHkyMDIwcmVkaWZmbWFpbC5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiI2ZllIRnJfS3UwcUFfeGtSVHJEVUFRIiwidmVyIjoiMS4wIiwieG1zX3N0Ijp7InN1YiI6ImxwYk5CSktQM2xRM29SaGRPbFh0QlZwcUtqeDdzU0VaNXVCaXRNSVQ0eUUifSwieG1zX3RjZHQiOjE1OTQ0NzA4MzN9.oYMqrR8K53slPeTlhaHe1GCCG9vp99ENJYjJzmvoyBevCltgKCSqz6qZL-US11cs7ynNINiMucYASm62RJ4qVZRfmbXgrTXTgRZUSB10FEJUje12roHwDZeTcxp90EGGvQMjOeofJqtOCEjMOmQjaCC0pK6Ll12rs0esLnvyHHIdayb_KMvUeQXkw4R8Xfs5w0Eyuz-QL8ZTRpbOHziGdXJZxw_e7V9G48U2CvBbZVSm5gcgqSs18lz6M9b-eO7oMW5Y6M4HJqlkVspraVig5YmONP14YQWHctDCZVdx5YLFXXe87wSdBIuPEM_kQKneRPoQM-fSZGFoEFjMOxTjkA


